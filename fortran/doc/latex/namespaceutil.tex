\hypertarget{namespaceutil}{}\section{util Module Reference}
\label{namespaceutil}\index{util@{util}}


Utility module.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
character(len=20) function, public \hyperlink{namespaceutil_a1df36d0696c9183ceb6bb770f1d88111}{str} (k)
\begin{DoxyCompactList}\small\item\em Convert an integer to string. \end{DoxyCompactList}\item 
character(len=40) function, public \hyperlink{namespaceutil_ac1630658a46867b1f7255eaa51198bf3}{rstr} (x, fm)
\begin{DoxyCompactList}\small\item\em Convert a real to string with a given format. \end{DoxyCompactList}\item 
integer function, dimension(size(s)), public \hyperlink{namespaceutil_a1e2cd46baa2070e28949e28c8a3e037e}{isin} (c, s)
\begin{DoxyCompactList}\small\item\em Determine if a character is in a string and where. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespaceutil_a3c2dcf05b068a55f0066d2b393e75dc7}{init\+\_\+random\+\_\+seed} ()
\begin{DoxyCompactList}\small\item\em Random generator initialization routine. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespaceutil_af8d0a8ec8cb7391ddbf455dc92f2189d}{piksrt} (k, arr, par)
\begin{DoxyCompactList}\small\item\em Simple card player sorting function. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespaceutil_aca7f2465fedb87fef954d8f0c30668c7}{init\+\_\+one} (A)
\begin{DoxyCompactList}\small\item\em Initialize a square matrix A as a unit matrix. \end{DoxyCompactList}\item 
real(kind=8) function, public \hyperlink{namespaceutil_a9771c95546d8658e72aa24f76612e4d8}{mat\+\_\+trace} (A)
\item 
real(kind=8) function, public \hyperlink{namespaceutil_a8a0e15c77e8cd4cb03b608e4d6bfba67}{mat\+\_\+contract} (A, B)
\item 
subroutine, public \hyperlink{namespaceutil_ab832eeb8a78ffacc12e3ceac27f95ee7}{choldc} (a, p)
\item 
subroutine, public \hyperlink{namespaceutil_a71eb7216e62e0978ad1424bd4dbd727a}{printmat} (A)
\item 
subroutine, public \hyperlink{namespaceutil_ac600300c2251c6c6b555fe7255605aa5}{cprintmat} (A)
\item 
real(kind=8) function, dimension(size(a, 1), size(a, 2)), public \hyperlink{namespaceutil_a52a5fbd944196d1cf077be77aefa34a2}{invmat} (A)
\item 
subroutine, public \hyperlink{namespaceutil_a85f87eae65cbe6d073cf10511fafdd3e}{triu} (A, T)
\item 
subroutine, public \hyperlink{namespaceutil_ac3ee7743cab41502961891d342823d35}{diag} (A, d)
\item 
subroutine, public \hyperlink{namespaceutil_a9e8cf4396837bb186d59791ca594a98e}{cdiag} (A, d)
\item 
integer function, public \hyperlink{namespaceutil_ae789c59b87d1c0607478b1718d26cd1d}{floordiv} (i, j)
\item 
subroutine, public \hyperlink{namespaceutil_a14b782ae34e59c2dcb260a5a69aae213}{reduce} (A, Ared, n, ind, rind)
\item 
subroutine, public \hyperlink{namespaceutil_a92433c6b81993d62682f54ff5c8834a0}{ireduce} (A, Ared, n, ind, rind)
\item 
subroutine, public \hyperlink{namespaceutil_aac7cb677d9eaa896447a48be3f9a973f}{vector\+\_\+outer} (u, v, A)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Utility module. 

\begin{DoxyCopyright}{Copyright}
2018 Lesley De Cruz \& Jonathan Demaeyer. See \hyperlink{LICENSE_8txt}{L\+I\+C\+E\+N\+S\+E.\+txt} for license information. 
\end{DoxyCopyright}


\subsection{Function/\+Subroutine Documentation}
\index{util@{util}!cdiag@{cdiag}}
\index{cdiag@{cdiag}!util@{util}}
\subsubsection[{\texorpdfstring{cdiag(\+A, d)}{cdiag(A, d)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::cdiag (
\begin{DoxyParamCaption}
\item[{complex(kind=16), dimension(\+:,\+:), intent(in)}]{A, }
\item[{complex(kind=16), dimension(\+:), intent(out)}]{d}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a9e8cf4396837bb186d59791ca594a98e}{}\label{namespaceutil_a9e8cf4396837bb186d59791ca594a98e}


Definition at line 269 of file util.\+f90.


\begin{DoxyCode}
269     \textcolor{keywordtype}{COMPLEX(KIND=16)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
270     \textcolor{keywordtype}{COMPLEX(KIND=16)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)} :: d
271     \textcolor{keywordtype}{INTEGER} :: i
272     
273     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
274        d(i)=a(i,i)
275 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!choldc@{choldc}}
\index{choldc@{choldc}!util@{util}}
\subsubsection[{\texorpdfstring{choldc(a, p)}{choldc(a, p)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::choldc (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:)}]{a, }
\item[{real(kind=8), dimension(\+:)}]{p}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_ab832eeb8a78ffacc12e3ceac27f95ee7}{}\label{namespaceutil_ab832eeb8a78ffacc12e3ceac27f95ee7}


Definition at line 176 of file util.\+f90.


\begin{DoxyCode}
176     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)} :: a
177     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)} :: p
178     \textcolor{keywordtype}{INTEGER} :: n
179     \textcolor{keywordtype}{INTEGER} :: i,j,k
180     \textcolor{keywordtype}{REAL(KIND=8)} :: sum
181     n=\textcolor{keyword}{size}(a,1)
182     \textcolor{keywordflow}{DO} i=1,n
183        \textcolor{keywordflow}{DO} j=i,n
184           sum=a(i,j)
185           \textcolor{keywordflow}{DO} k=i-1,1,-1
186              sum=sum-a(i,k)*a(j,k)
187 \textcolor{keywordflow}{          END DO}
188           \textcolor{keywordflow}{IF} (i.eq.j) \textcolor{keywordflow}{THEN}
189              \textcolor{keywordflow}{IF} (sum.le.0.) stop \textcolor{stringliteral}{'choldc failed'}
190              p(i)=sqrt(sum)
191           \textcolor{keywordflow}{ELSE}
192              a(j,i)=sum/p(i)
193 \textcolor{keywordflow}{          ENDIF}
194 \textcolor{keywordflow}{       END DO}
195 \textcolor{keywordflow}{    END DO}
196     \textcolor{keywordflow}{RETURN}
\end{DoxyCode}
\index{util@{util}!cprintmat@{cprintmat}}
\index{cprintmat@{cprintmat}!util@{util}}
\subsubsection[{\texorpdfstring{cprintmat(\+A)}{cprintmat(A)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::cprintmat (
\begin{DoxyParamCaption}
\item[{complex(kind=16), dimension(\+:,\+:), intent(in)}]{A}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_ac600300c2251c6c6b555fe7255605aa5}{}\label{namespaceutil_ac600300c2251c6c6b555fe7255605aa5}


Definition at line 209 of file util.\+f90.


\begin{DoxyCode}
209     \textcolor{keywordtype}{COMPLEX(KIND=16)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
210     \textcolor{keywordtype}{INTEGER} :: i
211     
212     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
213        print*, a(i,:)
214 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!diag@{diag}}
\index{diag@{diag}!util@{util}}
\subsubsection[{\texorpdfstring{diag(\+A, d)}{diag(A, d)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::diag (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(in)}]{A, }
\item[{real(kind=8), dimension(\+:), intent(out)}]{d}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_ac3ee7743cab41502961891d342823d35}{}\label{namespaceutil_ac3ee7743cab41502961891d342823d35}


Definition at line 259 of file util.\+f90.


\begin{DoxyCode}
259     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
260     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)} :: d
261     \textcolor{keywordtype}{INTEGER} :: i
262     
263     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
264        d(i)=a(i,i)
265 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!floordiv@{floordiv}}
\index{floordiv@{floordiv}!util@{util}}
\subsubsection[{\texorpdfstring{floordiv(i, j)}{floordiv(i, j)}}]{\setlength{\rightskip}{0pt plus 5cm}integer function, public util\+::floordiv (
\begin{DoxyParamCaption}
\item[{integer}]{i, }
\item[{integer}]{j}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_ae789c59b87d1c0607478b1718d26cd1d}{}\label{namespaceutil_ae789c59b87d1c0607478b1718d26cd1d}


Definition at line 280 of file util.\+f90.


\begin{DoxyCode}
280     \textcolor{keywordtype}{INTEGER} :: i,j,floordiv
281     floordiv=int(floor(\textcolor{keywordtype}{real}(i)/\textcolor{keywordtype}{real}(j)))
282     \textcolor{keywordflow}{RETURN}
\end{DoxyCode}
\index{util@{util}!init\+\_\+one@{init\+\_\+one}}
\index{init\+\_\+one@{init\+\_\+one}!util@{util}}
\subsubsection[{\texorpdfstring{init\+\_\+one(\+A)}{init_one(A)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::init\+\_\+one (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(inout)}]{A}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_aca7f2465fedb87fef954d8f0c30668c7}{}\label{namespaceutil_aca7f2465fedb87fef954d8f0c30668c7}


Initialize a square matrix A as a unit matrix. 



Definition at line 139 of file util.\+f90.


\begin{DoxyCode}
139      \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)},\textcolor{keywordtype}{INTENT(INOUT)} :: a
140      \textcolor{keywordtype}{INTEGER} :: i,n
141      n=\textcolor{keyword}{size}(a,1)
142      a=0.0d0
143      \textcolor{keywordflow}{DO} i=1,n
144        a(i,i)=1.0d0
145 \textcolor{keywordflow}{     END DO}
146 
\end{DoxyCode}
\index{util@{util}!init\+\_\+random\+\_\+seed@{init\+\_\+random\+\_\+seed}}
\index{init\+\_\+random\+\_\+seed@{init\+\_\+random\+\_\+seed}!util@{util}}
\subsubsection[{\texorpdfstring{init\+\_\+random\+\_\+seed()}{init_random_seed()}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::init\+\_\+random\+\_\+seed (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a3c2dcf05b068a55f0066d2b393e75dc7}{}\label{namespaceutil_a3c2dcf05b068a55f0066d2b393e75dc7}


Random generator initialization routine. 



Definition at line 64 of file util.\+f90.

\index{util@{util}!invmat@{invmat}}
\index{invmat@{invmat}!util@{util}}
\subsubsection[{\texorpdfstring{invmat(\+A)}{invmat(A)}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8) function, dimension(size(a,1),size(a,2)), public util\+::invmat (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(in)}]{A}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a52a5fbd944196d1cf077be77aefa34a2}{}\label{namespaceutil_a52a5fbd944196d1cf077be77aefa34a2}


Definition at line 218 of file util.\+f90.


\begin{DoxyCode}
218     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
219     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(SIZE(A,1),SIZE(A,2))} :: ainv
220 
221     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(SIZE(A,1))} :: work  \textcolor{comment}{! work array for LAPACK}
222     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(SIZE(A,1))} :: ipiv   \textcolor{comment}{! pivot indices}
223     \textcolor{keywordtype}{INTEGER} :: n, info
224 
225     \textcolor{comment}{! Store A in Ainv to prevent it from being overwritten by LAPACK}
226     ainv = a
227     n = \textcolor{keyword}{size}(a,1)
228 
229     \textcolor{comment}{! DGETRF computes an LU factorization of a general M-by-N matrix A}
230     \textcolor{comment}{! using partial pivoting with row interchanges.}
231     \textcolor{keyword}{CALL }dgetrf(n, n, ainv, n, ipiv, info)
232 
233     \textcolor{keywordflow}{IF} (info /= 0) \textcolor{keywordflow}{THEN}
234        stop \textcolor{stringliteral}{'Matrix is numerically singular!'}
235 \textcolor{keywordflow}{    ENDIF}
236 
237     \textcolor{comment}{! DGETRI computes the inverse of a matrix using the LU factorization}
238     \textcolor{comment}{! computed by DGETRF.}
239     \textcolor{keyword}{CALL }dgetri(n, ainv, n, ipiv, work, n, info)
240 
241     \textcolor{keywordflow}{IF} (info /= 0) \textcolor{keywordflow}{THEN}
242        stop \textcolor{stringliteral}{'Matrix inversion failed!'}
243 \textcolor{keywordflow}{    ENDIF}
\end{DoxyCode}
\index{util@{util}!ireduce@{ireduce}}
\index{ireduce@{ireduce}!util@{util}}
\subsubsection[{\texorpdfstring{ireduce(\+A, Ared, n, ind, rind)}{ireduce(A, Ared, n, ind, rind)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::ireduce (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(out)}]{A, }
\item[{real(kind=8), dimension(\+:,\+:), intent(in)}]{Ared, }
\item[{integer, intent(in)}]{n, }
\item[{integer, dimension(\+:), intent(in)}]{ind, }
\item[{integer, dimension(\+:), intent(in)}]{rind}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a92433c6b81993d62682f54ff5c8834a0}{}\label{namespaceutil_a92433c6b81993d62682f54ff5c8834a0}


Definition at line 314 of file util.\+f90.


\begin{DoxyCode}
314     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)} :: a
315     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: ared
316     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)} :: n
317     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: ind,rind
318     \textcolor{keywordtype}{INTEGER} :: i,j
319     a=0.d0
320     \textcolor{keywordflow}{DO} i=1,n
321        \textcolor{keywordflow}{DO} j=1,n
322           a(ind(i),ind(j))=ared(i,j)
323 \textcolor{keywordflow}{       END DO}
324 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!isin@{isin}}
\index{isin@{isin}!util@{util}}
\subsubsection[{\texorpdfstring{isin(c, s)}{isin(c, s)}}]{\setlength{\rightskip}{0pt plus 5cm}integer function, dimension(size(s)), public util\+::isin (
\begin{DoxyParamCaption}
\item[{character, intent(in)}]{c, }
\item[{character, dimension(\+:), intent(in)}]{s}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a1e2cd46baa2070e28949e28c8a3e037e}{}\label{namespaceutil_a1e2cd46baa2070e28949e28c8a3e037e}


Determine if a character is in a string and where. 

\begin{DoxyRemark}{Remarks}
\+: return positions in a vector if found and 0 vector if not found 
\end{DoxyRemark}


Definition at line 47 of file util.\+f90.


\begin{DoxyCode}
47     \textcolor{keywordtype}{CHARACTER}, \textcolor{keywordtype}{INTENT(IN)} :: c
48     \textcolor{keywordtype}{CHARACTER}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: s
49     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(size(s))} :: isin
50     \textcolor{keywordtype}{INTEGER} :: i,j
51 
52     isin=0
53     j=0
54     \textcolor{keywordflow}{DO} i=\textcolor{keyword}{size}(s),1,-1
55        \textcolor{keywordflow}{IF} (c==s(i)) \textcolor{keywordflow}{THEN}
56           j=j+1
57           isin(j)=i
58 \textcolor{keywordflow}{       END IF}
59 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!mat\+\_\+contract@{mat\+\_\+contract}}
\index{mat\+\_\+contract@{mat\+\_\+contract}!util@{util}}
\subsubsection[{\texorpdfstring{mat\+\_\+contract(\+A, B)}{mat_contract(A, B)}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8) function, public util\+::mat\+\_\+contract (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:)}]{A, }
\item[{real(kind=8), dimension(\+:,\+:)}]{B}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a8a0e15c77e8cd4cb03b608e4d6bfba67}{}\label{namespaceutil_a8a0e15c77e8cd4cb03b608e4d6bfba67}


Definition at line 162 of file util.\+f90.


\begin{DoxyCode}
162     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)} :: a,b
163     \textcolor{keywordtype}{REAL(KIND=8)} :: mat\_contract
164     \textcolor{keywordtype}{INTEGER} :: i,j,n
165     n=\textcolor{keyword}{size}(a,1)
166     mat\_contract=0.d0
167     \textcolor{keywordflow}{DO} i=1,n
168        \textcolor{keywordflow}{DO} j=1,n
169           mat\_contract=mat\_contract+a(i,j)*b(i,j)
170 \textcolor{keywordflow}{       END DO}
171 \textcolor{keywordflow}{    ENDDO}
172     \textcolor{keywordflow}{RETURN}
\end{DoxyCode}
\index{util@{util}!mat\+\_\+trace@{mat\+\_\+trace}}
\index{mat\+\_\+trace@{mat\+\_\+trace}!util@{util}}
\subsubsection[{\texorpdfstring{mat\+\_\+trace(\+A)}{mat_trace(A)}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8) function, public util\+::mat\+\_\+trace (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:)}]{A}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a9771c95546d8658e72aa24f76612e4d8}{}\label{namespaceutil_a9771c95546d8658e72aa24f76612e4d8}


Definition at line 150 of file util.\+f90.


\begin{DoxyCode}
150     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)} :: a
151     \textcolor{keywordtype}{REAL(KIND=8)} :: mat\_trace
152     \textcolor{keywordtype}{INTEGER} :: i,n
153     n=\textcolor{keyword}{size}(a,1)
154     mat\_trace=0.d0
155     \textcolor{keywordflow}{DO} i=1,n
156        mat\_trace=mat\_trace+a(i,i)
157 \textcolor{keywordflow}{    END DO}
158     \textcolor{keywordflow}{RETURN}
\end{DoxyCode}
\index{util@{util}!piksrt@{piksrt}}
\index{piksrt@{piksrt}!util@{util}}
\subsubsection[{\texorpdfstring{piksrt(k, arr, par)}{piksrt(k, arr, par)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::piksrt (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{k, }
\item[{integer, dimension(k), intent(inout)}]{arr, }
\item[{integer, intent(out)}]{par}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_af8d0a8ec8cb7391ddbf455dc92f2189d}{}\label{namespaceutil_af8d0a8ec8cb7391ddbf455dc92f2189d}


Simple card player sorting function. 



Definition at line 118 of file util.\+f90.


\begin{DoxyCode}
118     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)} :: k
119     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(k)}, \textcolor{keywordtype}{INTENT(INOUT)} :: arr
120     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(OUT)} :: par
121     \textcolor{keywordtype}{INTEGER} :: i,j,a,b
122 
123     par=1
124 
125     \textcolor{keywordflow}{DO} j=2,k
126        a=arr(j)
127        \textcolor{keywordflow}{DO} i=j-1,1,-1
128           \textcolor{keywordflow}{if}(arr(i).le.a) \textcolor{keywordflow}{EXIT}
129           arr(i+1)=arr(i)
130           par=-par
131 \textcolor{keywordflow}{       END DO}
132        arr(i+1)=a
133 \textcolor{keywordflow}{    ENDDO}
134     \textcolor{keywordflow}{RETURN}
\end{DoxyCode}
\index{util@{util}!printmat@{printmat}}
\index{printmat@{printmat}!util@{util}}
\subsubsection[{\texorpdfstring{printmat(\+A)}{printmat(A)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::printmat (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(in)}]{A}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a71eb7216e62e0978ad1424bd4dbd727a}{}\label{namespaceutil_a71eb7216e62e0978ad1424bd4dbd727a}


Definition at line 200 of file util.\+f90.


\begin{DoxyCode}
200     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
201     \textcolor{keywordtype}{INTEGER} :: i
202     
203     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
204        print*, a(i,:)
205 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!reduce@{reduce}}
\index{reduce@{reduce}!util@{util}}
\subsubsection[{\texorpdfstring{reduce(\+A, Ared, n, ind, rind)}{reduce(A, Ared, n, ind, rind)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::reduce (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(in)}]{A, }
\item[{real(kind=8), dimension(\+:,\+:), intent(out)}]{Ared, }
\item[{integer, intent(out)}]{n, }
\item[{integer, dimension(\+:), intent(out)}]{ind, }
\item[{integer, dimension(\+:), intent(out)}]{rind}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a14b782ae34e59c2dcb260a5a69aae213}{}\label{namespaceutil_a14b782ae34e59c2dcb260a5a69aae213}


Definition at line 286 of file util.\+f90.


\begin{DoxyCode}
286     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
287     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)} :: ared
288     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(OUT)} :: n
289     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)} :: ind,rind
290     \textcolor{keywordtype}{LOGICAL}, \textcolor{keywordtype}{DIMENSION(SIZE(A,1))} :: sel
291     \textcolor{keywordtype}{INTEGER} :: i,j
292 
293     ind=0
294     rind=0
295     sel=.false.
296     n=0
297     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
298        \textcolor{keywordflow}{IF} (any(a(i,:)/=0)) \textcolor{keywordflow}{THEN}
299           n=n+1
300           sel(i)=.true.
301           ind(n)=i
302           rind(i)=n
303 \textcolor{keywordflow}{       ENDIF}
304 \textcolor{keywordflow}{    END DO}
305     ared=0.d0
306     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
307        \textcolor{keywordflow}{DO} j=1,\textcolor{keyword}{SIZE}(a,1)
308           \textcolor{keywordflow}{IF} (sel(i).and.sel(j)) ared(rind(i),rind(j))=a(i,j)
309 \textcolor{keywordflow}{       ENDDO}
310 \textcolor{keywordflow}{    ENDDO}
\end{DoxyCode}
\index{util@{util}!rstr@{rstr}}
\index{rstr@{rstr}!util@{util}}
\subsubsection[{\texorpdfstring{rstr(x, fm)}{rstr(x, fm)}}]{\setlength{\rightskip}{0pt plus 5cm}character(len=40) function, public util\+::rstr (
\begin{DoxyParamCaption}
\item[{real(kind=8), intent(in)}]{x, }
\item[{character(len=20), intent(in)}]{fm}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_ac1630658a46867b1f7255eaa51198bf3}{}\label{namespaceutil_ac1630658a46867b1f7255eaa51198bf3}


Convert a real to string with a given format. 



Definition at line 38 of file util.\+f90.


\begin{DoxyCode}
38     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: x
39     \textcolor{keywordtype}{CHARACTER(len=20)}, \textcolor{keywordtype}{INTENT(IN)} :: fm
40     \textcolor{keyword}{WRITE} (rstr, trim(adjustl(fm))) x
41     rstr = adjustl(rstr)
\end{DoxyCode}
\index{util@{util}!str@{str}}
\index{str@{str}!util@{util}}
\subsubsection[{\texorpdfstring{str(k)}{str(k)}}]{\setlength{\rightskip}{0pt plus 5cm}character(len=20) function, public util\+::str (
\begin{DoxyParamCaption}
\item[{integer, intent(in)}]{k}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a1df36d0696c9183ceb6bb770f1d88111}{}\label{namespaceutil_a1df36d0696c9183ceb6bb770f1d88111}


Convert an integer to string. 



Definition at line 31 of file util.\+f90.


\begin{DoxyCode}
31     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)} :: k
32     \textcolor{keyword}{WRITE} (\hyperlink{namespaceutil_a1df36d0696c9183ceb6bb770f1d88111}{str}, *) k
33     \hyperlink{namespaceutil_a1df36d0696c9183ceb6bb770f1d88111}{str} = adjustl(\hyperlink{namespaceutil_a1df36d0696c9183ceb6bb770f1d88111}{str})
\end{DoxyCode}
\index{util@{util}!triu@{triu}}
\index{triu@{triu}!util@{util}}
\subsubsection[{\texorpdfstring{triu(\+A, T)}{triu(A, T)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::triu (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:,\+:), intent(in)}]{A, }
\item[{real(kind=8), dimension(\+:,\+:), intent(out)}]{T}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_a85f87eae65cbe6d073cf10511fafdd3e}{}\label{namespaceutil_a85f87eae65cbe6d073cf10511fafdd3e}


Definition at line 247 of file util.\+f90.


\begin{DoxyCode}
247     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)} :: a
248     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)} :: t
249     \textcolor{keywordtype}{INTEGER} i,j
250     t=0.d0
251     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(a,1)
252        \textcolor{keywordflow}{DO} j=i,\textcolor{keyword}{SIZE}(a,1)
253           t(i,j)=a(i,j)
254 \textcolor{keywordflow}{       END DO}
255 \textcolor{keywordflow}{    END DO}
\end{DoxyCode}
\index{util@{util}!vector\+\_\+outer@{vector\+\_\+outer}}
\index{vector\+\_\+outer@{vector\+\_\+outer}!util@{util}}
\subsubsection[{\texorpdfstring{vector\+\_\+outer(u, v, A)}{vector_outer(u, v, A)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public util\+::vector\+\_\+outer (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(\+:), intent(in)}]{u, }
\item[{real(kind=8), dimension(\+:), intent(in)}]{v, }
\item[{real(kind=8), dimension(\+:,\+:), intent(out)}]{A}
\end{DoxyParamCaption}
)}\hypertarget{namespaceutil_aac7cb677d9eaa896447a48be3f9a973f}{}\label{namespaceutil_aac7cb677d9eaa896447a48be3f9a973f}


Definition at line 328 of file util.\+f90.


\begin{DoxyCode}
328     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: u,v
329     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)} :: a
330     \textcolor{keywordtype}{INTEGER} :: i,j
331 
332     a=0.d0
333     \textcolor{keywordflow}{DO} i=1,\textcolor{keyword}{SIZE}(u)
334        \textcolor{keywordflow}{DO} j=1,\textcolor{keyword}{SIZE}(v)
335           a(i,j)=u(i)*v(j)
336 \textcolor{keywordflow}{       ENDDO}
337 \textcolor{keywordflow}{    ENDDO}
\end{DoxyCode}
