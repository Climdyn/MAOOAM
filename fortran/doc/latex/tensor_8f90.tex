\hypertarget{tensor_8f90}{}\section{tensor.\+f90 File Reference}
\label{tensor_8f90}\index{tensor.\+f90@{tensor.\+f90}}
\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \hyperlink{structtensor_1_1coolist__elem}{tensor\+::coolist\+\_\+elem}
\begin{DoxyCompactList}\small\item\em Coordinate list element type. Elementary elements of the sparse tensors. \end{DoxyCompactList}\item 
type \hyperlink{structtensor_1_1coolist__elem4}{tensor\+::coolist\+\_\+elem4}
\begin{DoxyCompactList}\small\item\em 4d coordinate list element type. Elementary elements of the 4d sparse tensors. \end{DoxyCompactList}\item 
type \hyperlink{structtensor_1_1coolist}{tensor\+::coolist}
\begin{DoxyCompactList}\small\item\em Coordinate list. Type used to represent the sparse tensor. \end{DoxyCompactList}\item 
type \hyperlink{structtensor_1_1coolist4}{tensor\+::coolist4}
\begin{DoxyCompactList}\small\item\em 4d coordinate list. Type used to represent the rank-\/4 sparse tensor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \hyperlink{namespacetensor}{tensor}
\begin{DoxyCompactList}\small\item\em Tensor utility module. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \hyperlink{namespacetensor_a4a88ee8077278486c5128ad97617969e}{tensor\+::copy\+\_\+tensor} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to copy a rank-\/3 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_aad7cd55f3a4cec4676cc7ca34b05f1a8}{tensor\+::add\+\_\+to\+\_\+tensor} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a rank-\/3 tensor to another one. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a4c63a1dd16bf751220f016b41bdaa78c}{tensor\+::add\+\_\+matc\+\_\+to\+\_\+tensor} (i, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a matrix to a rank-\/3 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_ab32e3f9d0aab15d2fa34dc3e509ee8bf}{tensor\+::add\+\_\+matc\+\_\+to\+\_\+tensor4} (i, j, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a matrix to a rank-\/4 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_aaa98410f224bc3dfb96cd7031f56e916}{tensor\+::add\+\_\+vec\+\_\+jk\+\_\+to\+\_\+tensor} (j, k, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a vector to a rank-\/3 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a9e443c5b0f095efdbb0df2e876b760be}{tensor\+::add\+\_\+vec\+\_\+ikl\+\_\+to\+\_\+tensor4\+\_\+perm} (i, k, l, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a vector to a rank-\/4 tensor plus permutation. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a4dd51ee85d6dffa3350880defc9823e8}{tensor\+::add\+\_\+vec\+\_\+ikl\+\_\+to\+\_\+tensor4} (i, k, l, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a vector to a rank-\/4 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_adfadc0660ec0e87b9d0dd3c383919d6b}{tensor\+::add\+\_\+vec\+\_\+ijk\+\_\+to\+\_\+tensor4} (i, j, k, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to add a vector to a rank-\/4 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a75d1a9ca8b39e9ad4b151a7b4b45c70f}{tensor\+::mat\+\_\+to\+\_\+coo} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a matrix to a rank-\/3 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a39f5944ef78c2d2aaac59477d8c6848f}{tensor\+::tensor\+\_\+to\+\_\+coo} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/3 tensor from matrix to coolist representation. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_ae8308730212d86ee401775f02f631310}{tensor\+::tensor4\+\_\+to\+\_\+coo4} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/4 tensor from matrix to coolist representation. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a5747516cd8a6fc9079fbb82d1b18dd98}{tensor\+::print\+\_\+tensor} (t)
\begin{DoxyCompactList}\small\item\em Routine to print a rank 3 tensor coolist. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_acb57d076f51b89419e4e8254ce13dd62}{tensor\+::print\+\_\+tensor4} (t)
\begin{DoxyCompactList}\small\item\em Routine to print a rank-\/4 tensor coolist. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a11054027a386918658f8948231af53b1}{tensor\+::sparse\+\_\+mul3} (coolist\+\_\+ijk, arr\+\_\+j, arr\+\_\+k, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/3 tensor coolist with two vectors\+: ${\displaystyle \sum_{j,k=0}^{ndim}} \mathcal{T}_{i,j,k} \, a_j \,b_k$. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a08965e1040a94fc58c1efa9ff9639118}{tensor\+::sparse\+\_\+mul3\+\_\+mat} (coolist\+\_\+ijk, arr\+\_\+k, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/3 tensor coolist with a vector\+: ${\displaystyle \sum_{k=0}^{ndim}} \mathcal{T}_{i,j,k} \, b_k$. Its output is a matrix. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_ab365e6dbb17e7fb26fef90649dd9e445}{tensor\+::sparse\+\_\+mul4} (coolist\+\_\+ijkl, arr\+\_\+j, arr\+\_\+k, arr\+\_\+l, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/4 tensor coolist with three vectors\+: ${\displaystyle \sum_{j,k,l=0}^{ndim}} \mathcal{T}_{i,j,k,l} \, a_j \,b_k \, c_l $. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a2fda12a024f8e3d0d6a167f264f6d000}{tensor\+::sparse\+\_\+mul4\+\_\+mat} (coolist\+\_\+ijkl, arr\+\_\+k, arr\+\_\+l, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a tensor with two vectors\+: ${\displaystyle \sum_{k,l=0}^{ndim}} \mathcal{T}_{i,j,k,l} \,b_k \, c_l $. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_add2a6aa993cd8a23be60d1643b5c7942}{tensor\+::jsparse\+\_\+mul} (coolist\+\_\+ijk, arr\+\_\+j, jcoo\+\_\+ij)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of two tensors to determine the Jacobian\+: \[J_{i,j} = {\displaystyle \sum_{k=0}^{ndim}} \left( \mathcal{T}_{i,j,k} + \mathcal{T}_{i,k,j} \right) \, a_k.\] It\textquotesingle{}s implemented slightly differently\+: for every $\mathcal{T}_{i,j,k}$, we add to $J_{i,j}$ as follows\+: \[J_{i,j} = J_{i,j} + \mathcal{T}_{i,j,k} \, a_k \\ J_{i,k} = J_{i,k} + \mathcal{T}_{i,j,k} \, a_j\] This version return a coolist (sparse tensor). \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a4135cf70df5030070922ff199c79cc03}{tensor\+::jsparse\+\_\+mul\+\_\+mat} (coolist\+\_\+ijk, arr\+\_\+j, jcoo\+\_\+ij)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of two tensors to determine the Jacobian\+: \[J_{i,j} = {\displaystyle \sum_{k=0}^{ndim}} \left( \mathcal{T}_{i,j,k} + \mathcal{T}_{i,k,j} \right) \, a_k.\] It\textquotesingle{}s implemented slightly differently\+: for every $\mathcal{T}_{i,j,k}$, we add to $J_{i,j}$ as follows\+: \[J_{i,j} = J_{i,j} + \mathcal{T}_{i,j,k} \, a_k \\ J_{i,k} = J_{i,k} + \mathcal{T}_{i,j,k} \, a_j\] This version return a matrix. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_ad9b09d91fb1bd425122c4f1ee2f0eb12}{tensor\+::sparse\+\_\+mul2\+\_\+j} (coolist\+\_\+ijk, arr\+\_\+j, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a 3d sparse tensor with a vectors\+: ${\displaystyle \sum_{j=0}^{ndim}} \mathcal{T}_{i,j,k} \, a_j $. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a90e31e5e782d63d7f05ee3c9aed370e0}{tensor\+::sparse\+\_\+mul2\+\_\+k} (coolist\+\_\+ijk, arr\+\_\+k, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/3 sparse tensor coolist with a vector\+: ${\displaystyle \sum_{k=0}^{ndim}} \mathcal{T}_{i,j,k} \, a_k $. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a364522b80ab0f4785c331eb74fa1ba04}{tensor\+::simplify} (tensor)
\begin{DoxyCompactList}\small\item\em Routine to simplify a coolist (sparse tensor). For each index $i$, it upper triangularize the matrix \[\mathcal{T}_{i,j,k} \qquad 0 \leq j,k \leq ndim.\]. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a52784eb2977ec36f8ab5ba240b497633}{tensor\+::coo\+\_\+to\+\_\+mat\+\_\+ik} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/3 tensor coolist component into a matrix with i and k indices. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_af104cb6f7354f1465eb53e0f3738a3d0}{tensor\+::coo\+\_\+to\+\_\+mat\+\_\+ij} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/3 tensor coolist component into a matrix with i and j indices. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_ac77bcc80d4bd189835b88db68ffafda4}{tensor\+::coo\+\_\+to\+\_\+mat\+\_\+i} (i, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/3 tensor coolist component into a matrix. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_abb370166c0ebd0885404c1703d464f89}{tensor\+::coo\+\_\+to\+\_\+vec\+\_\+jk} (j, k, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/3 tensor coolist component into a vector. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a2088d80a587fd931ca64976a87403401}{tensor\+::coo\+\_\+to\+\_\+mat\+\_\+j} (j, src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a rank-\/3 tensor coolist component into a matrix. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_aae291b0fab419ce7692da1933105e9ae}{tensor\+::sparse\+\_\+mul4\+\_\+with\+\_\+mat\+\_\+jl} (coolist\+\_\+ijkl, mat\+\_\+jl, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/4 tensor coolist with a matrix \+: ${\displaystyle \sum_{j,l=0}^{ndim}} \mathcal{T}_{i,j,k,l} \, m_{j,l} $. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_af65ad5ae657ecd97f70109b2c273696b}{tensor\+::sparse\+\_\+mul4\+\_\+with\+\_\+mat\+\_\+kl} (coolist\+\_\+ijkl, mat\+\_\+kl, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/4 tensor coolist with a matrix \+: ${\displaystyle \sum_{j,l=0}^{ndim}} \mathcal{T}_{i,j,k,l} \, m_{k,l} $. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a33bc74f9042478d58240b1a1a91db91d}{tensor\+::sparse\+\_\+mul3\+\_\+with\+\_\+mat} (coolist\+\_\+ijk, mat\+\_\+jk, res)
\begin{DoxyCompactList}\small\item\em Sparse multiplication of a rank-\/3 tensor coolist with a matrix\+: ${\displaystyle \sum_{j,k=0}^{ndim}} \mathcal{T}_{i,j,k} \, m_{j,k}$. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_ad868662d382dc1579db6847f2411c382}{tensor\+::matc\+\_\+to\+\_\+coo} (src, dst)
\begin{DoxyCompactList}\small\item\em Routine to convert a matrix to a rank-\/3 tensor. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_af105ec6083969c52f5e7422d75a5cda5}{tensor\+::scal\+\_\+mul\+\_\+coo} (s, t)
\begin{DoxyCompactList}\small\item\em Routine to multiply a rank-\/3 tensor by a scalar. \end{DoxyCompactList}\item 
logical function, public \hyperlink{namespacetensor_ab08af814baeb0b670bd5d587ca578239}{tensor\+::tensor\+\_\+empty} (t)
\begin{DoxyCompactList}\small\item\em Test if a rank-\/3 tensor coolist is empty. \end{DoxyCompactList}\item 
logical function, public \hyperlink{namespacetensor_a9b00b4f3cebb865971bcbaf818602ddc}{tensor\+::tensor4\+\_\+empty} (t)
\begin{DoxyCompactList}\small\item\em Test if a rank-\/4 tensor coolist is empty. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a373dab2b483b4bc5f521934660d289aa}{tensor\+::load\+\_\+tensor4\+\_\+from\+\_\+file} (s, t)
\begin{DoxyCompactList}\small\item\em Load a rank-\/4 tensor coolist from a file definition. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetensor_a328cec7eb0ae3c472db0f9ccdd475763}{tensor\+::write\+\_\+tensor4\+\_\+to\+\_\+file} (s, t)
\begin{DoxyCompactList}\small\item\em Load a rank-\/4 tensor coolist from a file definition. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
real(kind=8), parameter \hyperlink{namespacetensor_a2a2ab182d86107e62533c3f0043652cc}{tensor\+::real\+\_\+eps} = 2.\+2204460492503131e-\/16
\begin{DoxyCompactList}\small\item\em Parameter to test the equality with zero. \end{DoxyCompactList}\end{DoxyCompactItemize}
